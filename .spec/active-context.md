# Active Context: Image Editor SDK (å¤§ç§˜ç¾Žå›¾)

> **Last Updated**: 2025-12-21
> **Current Focus**: Smart Inpaint (Refining), Mosaic Tool, Puzzle Stitching

## 1. ðŸš§ æ­£åœ¨è¿›è¡Œä¸­çš„æ¨¡å— (Work In Progress)

### 1.1 è°ƒæ•´æ¨¡å— (Adjust Module)

- [ ] **æ™ºèƒ½æ¶ˆé™¤ç¬” (Smart Inpaint)**
  - **çŠ¶æ€**: æ ¸å¿ƒä»£ç å·²ç”Ÿæˆ (åŒæ¨¡å¼ï¼šç”»ç¬”+æ¡†é€‰)ï¼Œå¤„äºŽè°ƒè¯•/å®Œå–„é˜¶æ®µã€‚
  - **ä¾èµ–**: å…¨å±€ Loading ç»„ä»¶ (å·²å°±ç»ª)ï¼ŒAPI æŽ¥å£ã€‚
- [ ] **é©¬èµ›å…‹ (Mosaic)**
  - **çŠ¶æ€**: å¾…å¯åŠ¨ã€‚
  - **ç›®æ ‡**: å®žçŽ°å±€éƒ¨é©¬èµ›å…‹æ¶‚æŠ¹æˆ–é€‰åŒºé©¬èµ›å…‹å¤„ç†ã€‚

### 1.2 æ‹¼å›¾æ¨¡å— (Puzzle Module)

- [ ] **æ‹¼æŽ¥ (Stitch/Join)**
  - **çŠ¶æ€**: å¾…å¯åŠ¨ã€‚
  - **ç›®æ ‡**: å®žçŽ°å¤šå›¾åž‚ç›´æˆ–æ°´å¹³é•¿å›¾æ‹¼æŽ¥ã€‚

---

## 2. âœ… å·²å®žçŽ°åŠŸèƒ½æ¸…å• (Implemented Features)

### 2.1 è°ƒæ•´æ¨¡å— (Adjust Module)

> ä½ç½®: `src/components/modules/adjust/`

- [x] **å‰ªè£/æ—‹è½¬ (Crop / Rotate)**: å›¾ç‰‡è£å‰ªã€ä»»æ„è§’åº¦æ—‹è½¬ã€‚
- [x] **è°ƒæ•´å°ºå¯¸ (Resize)**: ä¿®æ”¹å›¾ç‰‡åƒç´ å°ºå¯¸ã€‚
- [x] **å›¾ç‰‡è¡¥ç™½ (Padding)**: æ‰©å±•ç”»å¸ƒèƒŒæ™¯ï¼Œå¢žåŠ ç•™ç™½ã€‚
- [x] **è‰²å½©è°ƒèŠ‚ (Color Adjust)**: äº®åº¦ã€å¯¹æ¯”åº¦ã€é¥±å’Œåº¦ç­‰åŸºç¡€è°ƒèŠ‚ã€‚
- [x] **é¢œè‰²å åŠ  (Color Overlay)**: å›¾ç‰‡æ··åˆæ¨¡å¼é¢œè‰²è¦†ç›–ã€‚
- [x] **æ»¤é•œæ•ˆæžœ (Filters)**: åŸºäºŽ Fabric.js æ»¤é•œç³»ç»Ÿçš„é¢„è®¾æ•ˆæžœã€‚

### 2.2 æ‹¼å›¾æ¨¡å— (Puzzle Module)

> ä½ç½®: `src/components/modules/puzzle/`

- [x] **ç½‘æ ¼æ‹¼å›¾ (Grid)**: æ ‡å‡†çš„æ ¼å­æ‹¼å›¾å¸ƒå±€ã€‚

### 2.3 åŸºç¡€è®¾æ–½ (Infrastructure)

- [x] **æ ¸å¿ƒå¼•æ“Ž**: Fabric.js v5.3 åˆå§‹åŒ– (`markRaw` ä¼˜åŒ–)ã€‚
- [x] **çŠ¶æ€ç®¡ç†**: `useEditorState` å•ä¾‹ã€‚
- [x] **å…¨å±€äº¤äº’**: å…¨å± Loading é®ç½© (`LoadingOverlay`)ã€‚

---

## 3. ðŸš€ æœ€è¿‘å˜æ›´æ—¥å¿— (Recent Changes)

- **[Feature] æ¶ˆé™¤ç¬” (In Progress)**:
  - å®žçŽ°äº†åŒæ¨¡å¼äº¤äº’ï¼ˆç”»ç¬”æ¶‚æŠ¹ + çŸ©å½¢æ¡†é€‰ï¼‰ã€‚
  - å‡çº§äº† `useCanvas.js` çš„ `exportMask` é€»è¾‘ï¼Œæ”¯æŒéž Path å¯¹è±¡å¯¼å‡ºã€‚
- **[Infra] åŸºå»º**:
  - å»ºç«‹äº†å…¨å±€å¼‚æ­¥ Loading æœºåˆ¶ã€‚
  - å‡çº§é¡¹ç›®å®ªç« è‡³ **v3.5** (åŒ…å« UI è§„èŒƒä¸Žæ£€æŸ¥æ¸…å•)ã€‚

---

## 4. ðŸ§  æž¶æž„ä¸Žçº¦æŸè®°å¿† (Architecture Memory)

> AI åœ¨å¼€å‘â€œé©¬èµ›å…‹â€å’Œâ€œæ‹¼æŽ¥â€æ–°åŠŸèƒ½æ—¶å¿…é¡»éµå®ˆï¼š

1.  **Fabric.js v5**: ä¸¥ç¦ä½¿ç”¨ v6 APIã€‚
2.  **æ€§èƒ½å®‰å…¨**: æ–°å¢žçš„ Fabric å¯¹è±¡æ“ä½œå¿…é¡»æ³¨æ„å“åº”å¼é™·é˜±ï¼Œå¤æ‚å¯¹è±¡ç¦æ­¢æ·±åº¦ä»£ç†ã€‚
3.  **UI ä¸€è‡´æ€§**:
    - æ–°å¼€å‘çš„â€œé©¬èµ›å…‹â€å’Œâ€œæ‹¼æŽ¥â€é¢æ¿ï¼ŒUI å¿…é¡»å¤ç”¨ `tool-panel-content`, `btn-primary` ç­‰æ ‡å‡†ç±»åã€‚
    - ä¸¥ç¦ç¡¬ç¼–ç é¢œè‰²ï¼Œå¿…é¡»ä½¿ç”¨ CSS å˜é‡ã€‚
4.  **æ¨¡å—åŒ–**:
    - é©¬èµ›å…‹é€»è¾‘ -> `useCanvasMosaic.js`
    - æ‹¼æŽ¥é€»è¾‘ -> `useCanvasStitch.js`
