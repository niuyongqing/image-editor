/** @license @lljj/vue3-form-ant (c) 2020-2024 Liu.Jun License: Apache-2.0 */
import {
  h as e,
  inject as t,
  computed as r,
  ref as a,
  watch as n,
  toRaw as o,
  getCurrentInstance as i,
  toRef as u,
  provide as l,
  defineComponent as c,
  onMounted as s,
} from "vue";
import {
  resolveComponent as m,
  getPathVal as d,
  setPathVal as p,
  isRootNodePath as f,
  path2prop as h,
  computedCurPath as v,
  deletePathVal as y,
  nodePath2ClassName as b,
  modelValueComponent as g,
} from "@lljj/vjsf-utils/vue3Utils";
import * as O from "@lljj/vjsf-utils/vue3Utils";
export { O as vueUtils };
export { modelValueComponent } from "@lljj/vjsf-utils/vue3Utils";
import S from "@lljj/vjsf-utils/schema/getDefaultFormState";
export { default as getDefaultFormState } from "@lljj/vjsf-utils/schema/getDefaultFormState";
import {
  isObject as P,
  genId as F,
  lowerCase as D,
  getSchemaType as k,
  isEmptyObject as j,
  filterObject as w,
  deepEquals as N,
} from "@lljj/vjsf-utils/utils";
import {
  fallbackLabel as x,
  getUiOptions as A,
  orderProperties as I,
  isSelect as T,
  optionsList as W,
  getWidgetConfig as C,
  replaceArrayIndex as L,
  allowAdditionalItems as M,
  getUserUiOptions as _,
  isMultiSelect as B,
  isFixedItems as E,
  getUserErrOptions as V,
  getUiField as R,
  isHiddenWidget as q,
} from "@lljj/vjsf-utils/formUtils";
import * as U from "@lljj/vjsf-utils/formUtils";
export { U as formUtils };
import $ from "@lljj/vjsf-utils/schema/retriev";
import G from "@lljj/vjsf-utils/components/FieldGroupWrap.vue";
import {
  IconQuestion as z,
  IconCaretUp as Y,
  IconCaretDown as H,
  IconClose as K,
  IconPlus as Z,
} from "@lljj/vjsf-utils/icons";
import {
  validateFormDataAndTransformMsg as J,
  isValid as Q,
  getMatchingOption as X,
} from "@lljj/vjsf-utils/schema/validate";
import * as ee from "@lljj/vjsf-utils/schema/validate";
export { ee as schemaValidate };
import {
  cutOff as te,
  moveUpAt as re,
  moveDownAt as ae,
  removeAt as ne,
} from "@lljj/vjsf-utils/arrayUtils";
function oe(e, t, r) {
  return (
    t in e
      ? Object.defineProperty(e, t, {
          value: r,
          enumerable: !0,
          configurable: !0,
          writable: !0,
        })
      : (e[t] = r),
    e
  );
}
function ie(e, t) {
  var r = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var a = Object.getOwnPropertySymbols(e);
    t &&
      (a = a.filter(function (t) {
        return Object.getOwnPropertyDescriptor(e, t).enumerable;
      })),
      r.push.apply(r, a);
  }
  return r;
}
function ue(e) {
  for (var t = 1; t < arguments.length; t++) {
    var r = null != arguments[t] ? arguments[t] : {};
    t % 2
      ? ie(Object(r), !0).forEach(function (t) {
          oe(e, t, r[t]);
        })
      : Object.getOwnPropertyDescriptors
        ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r))
        : ie(Object(r)).forEach(function (t) {
            Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(r, t));
          });
  }
  return e;
}
function le(e, t) {
  if (null == e) return {};
  var r,
    a,
    n = (function (e, t) {
      if (null == e) return {};
      var r,
        a,
        n = {},
        o = Object.keys(e);
      for (a = 0; a < o.length; a++)
        (r = o[a]), t.indexOf(r) >= 0 || (n[r] = e[r]);
      return n;
    })(e, t);
  if (Object.getOwnPropertySymbols) {
    var o = Object.getOwnPropertySymbols(e);
    for (a = 0; a < o.length; a++)
      (r = o[a]),
        t.indexOf(r) >= 0 ||
          (Object.prototype.propertyIsEnumerable.call(e, r) && (n[r] = e[r]));
  }
  return n;
}
function ce(e, t) {
  return (
    (function (e) {
      if (Array.isArray(e)) return e;
    })(e) ||
    (function (e, t) {
      if ("undefined" == typeof Symbol || !(Symbol.iterator in Object(e)))
        return;
      var r = [],
        a = !0,
        n = !1,
        o = void 0;
      try {
        for (
          var i, u = e[Symbol.iterator]();
          !(a = (i = u.next()).done) && (r.push(i.value), !t || r.length !== t);
          a = !0
        );
      } catch (e) {
        (n = !0), (o = e);
      } finally {
        try {
          a || null == u.return || u.return();
        } finally {
          if (n) throw o;
        }
      }
      return r;
    })(e, t) ||
    me(e, t) ||
    (function () {
      throw new TypeError(
        "Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.",
      );
    })()
  );
}
function se(e) {
  return (
    (function (e) {
      if (Array.isArray(e)) return de(e);
    })(e) ||
    (function (e) {
      if ("undefined" != typeof Symbol && Symbol.iterator in Object(e))
        return Array.from(e);
    })(e) ||
    me(e) ||
    (function () {
      throw new TypeError(
        "Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.",
      );
    })()
  );
}
function me(e, t) {
  if (e) {
    if ("string" == typeof e) return de(e, t);
    var r = Object.prototype.toString.call(e).slice(8, -1);
    return (
      "Object" === r && e.constructor && (r = e.constructor.name),
      "Map" === r || "Set" === r
        ? Array.from(e)
        : "Arguments" === r ||
            /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)
          ? de(e, t)
          : void 0
    );
  }
}
function de(e, t) {
  (null == t || t > e.length) && (t = e.length);
  for (var r = 0, a = new Array(t); r < t; r++) a[r] = e[r];
  return a;
}
function pe(e) {
  var t = (function (e, t) {
    if ("object" != typeof e || null === e) return e;
    var r = e[Symbol.toPrimitive];
    if (void 0 !== r) {
      var a = r.call(e, t || "default");
      if ("object" != typeof a) return a;
      throw new TypeError("@@toPrimitive must return a primitive value.");
    }
    return ("string" === t ? String : Number)(e);
  })(e, "string");
  return "symbol" == typeof t ? t : String(t);
}
var fe = {
    formFooter: {
      type: Object,
      default: function () {
        return { show: !0, okBtn: "保存", cancelBtn: "取消" };
      },
    },
    modelValue: {
      type: null,
      default: function () {
        return {};
      },
      required: !0,
    },
    fallbackLabel: { type: Boolean, default: !1 },
    strictMode: { type: Boolean, default: !1 },
    formProps: {
      type: Object,
      default: function () {
        return {};
      },
    },
    schema: {
      type: Object,
      default: function () {
        return {};
      },
      required: !0,
    },
    uiSchema: {
      type: Object,
      default: function () {
        return {};
      },
    },
    customFormats: {
      type: Object,
      default: function () {
        return {};
      },
    },
    customRule: { type: Function, default: null },
    errorSchema: {
      type: Object,
      default: function () {
        return {};
      },
    },
  },
  he = {
    name: "FormFooter",
    props: {
      okBtn: { type: String, default: "保存" },
      okBtnProps: {
        type: Object,
        default: function () {
          return {};
        },
      },
      cancelBtn: { type: String, default: "取消" },
      formItemAttrs: {
        type: Object,
        default: function () {
          return {};
        },
      },
      globalOptions: {
        type: Object,
        default: function () {
          return {};
        },
      },
    },
    emits: ["cancel", "submit"],
    setup: function (t, r) {
      var a = r.emit,
        n = t.globalOptions.COMPONENT_MAP;
      return function () {
        return e(
          m(n.formItem),
          ue({ class: { formFooter_item: !0 } }, t.formItemAttrs),
          {
            default: function () {
              return [
                e(
                  m(n.button),
                  {
                    onClick: function () {
                      a("cancel");
                    },
                  },
                  {
                    default: function () {
                      return t.cancelBtn;
                    },
                  },
                ),
                e(
                  m(n.button),
                  ue(
                    {
                      style: { marginLeft: "10px" },
                      type: "primary",
                      onClick: function () {
                        a("submit");
                      },
                    },
                    t.okBtnProps,
                  ),
                  {
                    default: function () {
                      return t.okBtn;
                    },
                  },
                ),
              ];
            },
          },
        );
      };
    },
  },
  ve = {
    formProps: { type: null },
    globalOptions: { type: null },
    schema: {
      type: Object,
      default: function () {
        return {};
      },
    },
    uiSchema: {
      type: Object,
      default: function () {
        return {};
      },
    },
    errorSchema: {
      type: Object,
      default: function () {
        return {};
      },
    },
    customRule: { type: Function, default: null },
    customFormats: {
      type: Object,
      default: function () {
        return {};
      },
    },
    rootSchema: {
      type: Object,
      default: function () {
        return {};
      },
    },
    rootFormData: {
      type: null,
      default: function () {
        return {};
      },
    },
    curNodePath: { type: String, default: "" },
    required: { type: Boolean, default: !1 },
    needValidFieldGroup: { type: Boolean, default: !0 },
  },
  ye = {
    name: "Widget",
    props: {
      isFormData: { type: Boolean, default: !0 },
      curValue: { type: null, default: 0 },
      schema: {
        type: Object,
        default: function () {
          return {};
        },
      },
      uiSchema: {
        type: Object,
        default: function () {
          return {};
        },
      },
      errorSchema: {
        type: Object,
        default: function () {
          return {};
        },
      },
      customFormats: {
        type: Object,
        default: function () {
          return {};
        },
      },
      customRule: { type: Function, default: null },
      widget: { type: [String, Function, Object], default: null },
      required: { type: Boolean, default: !1 },
      uiRequired: { type: Boolean },
      emptyValue: { type: null, default: void 0 },
      rootFormData: { type: null },
      curNodePath: { type: String, default: "" },
      label: { type: String, default: "" },
      width: { type: String, default: "" },
      labelWidth: { type: String, default: "" },
      description: { type: String, default: "" },
      widgetAttrs: {
        type: Object,
        default: function () {
          return {};
        },
      },
      widgetClass: {
        type: Object,
        default: function () {
          return {};
        },
      },
      widgetStyle: {
        type: Object,
        default: function () {
          return {};
        },
      },
      fieldAttrs: {
        type: Object,
        default: function () {
          return {};
        },
      },
      fieldClass: {
        type: Object,
        default: function () {
          return {};
        },
      },
      fieldStyle: {
        type: Object,
        default: function () {
          return {};
        },
      },
      uiProps: {
        type: Object,
        default: function () {
          return {};
        },
      },
      formProps: null,
      getWidget: null,
      renderScopedSlots: null,
      globalOptions: null,
      onChange: null,
    },
    emits: ["otherDataChange"],
    inheritAttrs: !0,
    setup: function (o, i) {
      var u = i.emit,
        l = t("genFormProvide"),
        c = r({
          get: function () {
            return o.isFormData ? d(o.rootFormData, o.curNodePath) : o.curValue;
          },
          set: function (e) {
            var t = "" === e || null === e ? o.emptyValue : e;
            o.isFormData
              ? p(o.rootFormData, o.curNodePath, t)
              : u("otherDataChange", t);
          },
        }),
        s = r(function () {
          var e;
          return null !== (e = o.uiRequired) && void 0 !== e ? e : o.required;
        });
      o.uiProps.enumOptions &&
        o.uiProps.enumOptions.length > 0 &&
        void 0 === c.value &&
        c.value !== o.uiProps.enumOptions[0] &&
        (o.schema.items
          ? (c.value = [])
          : s.value &&
            o.formProps.defaultSelectFirstOption &&
            (c.value = o.uiProps.enumOptions[0].value));
      var v = a(null);
      return (
        "function" == typeof o.getWidget &&
          n(v, function () {
            o.getWidget.call(null, v.value);
          }),
        function () {
          var t,
            r = f(o.curNodePath),
            a = o.formProps && o.formProps.isMiniDes,
            n = null != a ? a : o.globalOptions.HELPERS.isMiniDes(o.formProps),
            i = o.description
              ? e("div", {
                  innerHTML: o.description,
                  class: { genFromWidget_des: !0, genFromWidget_des_mini: n },
                })
              : null,
            u = o.globalOptions.COMPONENT_MAP,
            p =
              n && i
                ? e(
                    m(u.popover),
                    ue(
                      {
                        style: {
                          margin: "0 2px",
                          fontSize: "16px",
                          cursor: "pointer",
                        },
                        placement: "top",
                        trigger: "hover",
                      },
                      null === (t = o.formProps) || void 0 === t
                        ? void 0
                        : t.popover,
                    ),
                    {
                      default: function () {
                        return i;
                      },
                      reference: function () {
                        return e(z);
                      },
                    },
                  )
                : null,
            y = ue(
              ue({}, o.fieldStyle),
              o.width
                ? { width: o.width, flexBasis: o.width, paddingRight: "10px" }
                : {},
            ),
            b = x(o.label, o.widget && l.fallbackLabel.value, o.curNodePath);
          return e(
            m(u.formItem),
            ue(
              ue(
                ue(
                  {
                    class: ue(ue({}, o.fieldClass), {}, { genFormItem: !0 }),
                    style: y,
                  },
                  o.fieldAttrs,
                ),
                {},
                { description: o.description, _title: b },
                o.labelWidth ? { labelWidth: o.labelWidth } : {},
              ),
              o.isFormData
                ? {
                    prop: r ? "__$$root" : h(o.curNodePath),
                    rules: [
                      {
                        validator: function (e, t, a) {
                          r && (t = o.rootFormData);
                          var n = J({
                            formData: t,
                            schema: o.schema,
                            uiSchema: o.uiSchema,
                            customFormats: o.customFormats,
                            errorSchema: o.errorSchema,
                            required: s.value,
                            propPath: h(o.curNodePath),
                          });
                          if (n.length > 0)
                            return a
                              ? a(n[0].message)
                              : Promise.reject(n[0].message);
                          var i = o.customRule;
                          return i && "function" == typeof i
                            ? i({
                                field: o.curNodePath,
                                value: t,
                                rootFormData: o.rootFormData,
                                callback: a,
                              })
                            : a
                              ? a()
                              : Promise.resolve();
                        },
                        trigger: "change",
                      },
                    ],
                  }
                : {},
            ),
            ue(
              ue(
                {
                  error: function (t) {
                    return t.error
                      ? e(
                          "div",
                          { class: { formItemErrorBox: !0 }, title: t.error },
                          [t.error],
                        )
                      : null;
                  },
                },
                b
                  ? {
                      label: function () {
                        return e(
                          "span",
                          {
                            class: {
                              genFormLabel: !0,
                              genFormItemRequired: s.value,
                            },
                          },
                          ["".concat(b)].concat(se(p ? [p] : []), [
                            "".concat(
                              (o.formProps && o.formProps.labelSuffix) || "",
                            ),
                          ]),
                        );
                      },
                    }
                  : {},
              ),
              {},
              {
                default: function (t) {
                  return [].concat(
                    se(!n && i ? [i] : []),
                    se(
                      o.widget
                        ? [
                            e(
                              m(o.widget),
                              ue(
                                ue(
                                  ue(
                                    {
                                      style: o.widgetStyle,
                                      class: o.widgetClass,
                                    },
                                    o.widgetAttrs,
                                  ),
                                  o.uiProps,
                                ),
                                {},
                                {
                                  modelValue: c.value,
                                  ref: v,
                                  "onUpdate:modelValue": function (e) {
                                    var t = c.value;
                                    t !== e &&
                                      ((c.value = e),
                                      o.onChange &&
                                        o.onChange({
                                          curVal: e,
                                          preVal: t,
                                          parentFormData: d(
                                            o.rootFormData,
                                            o.curNodePath,
                                            1,
                                          ),
                                          rootFormData: o.rootFormData,
                                        }));
                                  },
                                },
                                t
                                  ? Object.keys(t).reduce(function (e, r) {
                                      return (
                                        (e[r] = t[r]),
                                        [
                                          o.widgetAttrs[r],
                                          o.uiProps[r],
                                        ].forEach(function (t) {
                                          t &&
                                            "function" == typeof t &&
                                            (e[r] = function () {
                                              t.apply(void 0, arguments),
                                                e[r].apply(e, arguments);
                                            });
                                        }),
                                        e
                                      );
                                    }, {})
                                  : {},
                              ),
                              ue(
                                {},
                                o.renderScopedSlots
                                  ? "function" == typeof o.renderScopedSlots
                                    ? o.renderScopedSlots()
                                    : o.renderScopedSlots
                                  : {},
                              ),
                            ),
                          ]
                        : [],
                    ),
                  );
                },
              },
            ),
          );
        }
      );
    },
  },
  be = {
    name: "ObjectField",
    props: ve,
    setup: function (t) {
      return function () {
        var r = t.curNodePath,
          a = A({
            schema: t.schema,
            uiSchema: t.uiSchema,
            curNodePath: r,
            rootFormData: t.rootFormData,
          }),
          n = a.title,
          o = a.description,
          i = a.showTitle,
          u = a.showDescription,
          l = a.order,
          c = a.fieldClass,
          s = a.fieldAttrs,
          m = a.fieldStyle,
          p = a.onlyShowIfDependent,
          f = Object.keys(t.schema.properties || {}),
          h = I(f, l).map(function (a) {
            var n = (function (e) {
                return (
                  Array.isArray(t.schema.required) &&
                  !!~t.schema.required.indexOf(e)
                );
              })(a),
              o = (function (e) {
                var r = !1,
                  a = !1;
                return (
                  P(t.schema.dependencies) &&
                    (a = Object.entries(t.schema.dependencies).some(
                      function (a) {
                        var n = ce(a, 2),
                          o = n[0],
                          i = n[1],
                          u = !(!Array.isArray(i) || !~i.indexOf(e));
                        return (
                          (r = r || u),
                          u && void 0 !== d(t.rootFormData, t.curNodePath)[o]
                        );
                      },
                    )),
                  { isDependency: r, curDependent: a }
                );
              })(a),
              i = o.isDependency,
              u = o.curDependent;
            return i && p && !u
              ? null
              : e(
                  Ie,
                  ue(
                    ue({ key: a }, t),
                    {},
                    {
                      schema: t.schema.properties[a],
                      uiSchema: t.uiSchema[a],
                      errorSchema: t.errorSchema[a],
                      required: n || u,
                      curNodePath: v(r, a),
                    },
                  ),
                );
          });
        return e(
          G,
          ue(
            {
              title: n,
              description: o,
              showTitle: i,
              showDescription: u,
              curNodePath: r,
              class: ue({}, c),
              style: m,
            },
            s,
          ),
          {
            default: function () {
              return [].concat(
                se(h),
                se(
                  t.needValidFieldGroup
                    ? [
                        e(ye, {
                          key: "validateWidget-object",
                          class: {
                            validateWidget: !0,
                            "validateWidget-object": !0,
                          },
                          schema: Object.entries(t.schema).reduce(function (
                            e,
                            r,
                          ) {
                            var a = ce(r, 2),
                              n = a[0],
                              o = a[1];
                            return (
                              (!1 !== t.schema.additionalProperties &&
                                ["properties", "id", "$id"].includes(n)) ||
                                (e[n] = o),
                              e
                            );
                          }, {}),
                          uiSchema: t.uiSchema,
                          errorSchema: t.errorSchema,
                          curNodePath: r,
                          rootFormData: t.rootFormData,
                          globalOptions: t.globalOptions,
                        }),
                      ]
                    : [],
                ),
              );
            },
          },
        );
      };
    },
  },
  ge = {
    name: "StringField",
    props: ve,
    setup: function (t, a) {
      var n = a.attrs,
        o = r(function () {
          var e =
              T(t.schema) &&
              W(t.schema, t.uiSchema, t.curNodePath, t.rootFormData),
            r = C(
              {
                schema: t.schema,
                uiSchema: t.uiSchema,
                curNodePath: t.curNodePath,
                rootFormData: t.rootFormData,
              },
              function () {
                var r =
                  "number" === t.schema.type || "integer" === t.schema.type;
                return {
                  widget: e
                    ? t.globalOptions.WIDGET_MAP.common.select
                    : t.globalOptions.WIDGET_MAP.formats[t.schema.format] ||
                      (r
                        ? t.globalOptions.WIDGET_MAP.types.number
                        : t.globalOptions.WIDGET_MAP.types.string),
                };
              },
            );
          return e && !r.uiProps.enumOptions && (r.uiProps.enumOptions = e), r;
        });
      return function () {
        return e(ye, ue(ue(ue({}, t), n), o.value));
      };
    },
  },
  Oe = {
    name: "NumberField",
    props: ve,
    setup: function (t, r) {
      var a = r.attrs;
      return function () {
        return e(ge, ue(ue({}, t), a));
      };
    },
  },
  Se = {
    name: "IntegerField",
    props: ve,
    setup: function (t, r) {
      var a = r.attrs;
      return function () {
        return e(ge, ue(ue({}, t), a));
      };
    },
  },
  Pe = {
    name: "BooleanField",
    props: ve,
    setup: function (t, r) {
      var a = r.attrs;
      return function () {
        var r = t.schema,
          n = t.uiSchema,
          o = t.curNodePath,
          i = t.rootFormData,
          u = t.globalOptions,
          l = W(
            {
              enumNames: r.enumNames || ["true", "false"],
              enum: r.enum || [!0, !1],
            },
            n,
            o,
            i,
          ),
          c = C(
            { schema: r, uiSchema: n, curNodePath: o, rootFormData: i },
            function () {
              return { widget: u.WIDGET_MAP.types.boolean };
            },
          );
        return (
          (c.uiProps.enumOptions = c.uiProps.enumOptions || l),
          e(ye, ue(ue(ue({}, a), t), c))
        );
      };
    },
  },
  Fe = {
    name: "ArrayOrderList",
    emits: ["arrayOperate"],
    props: {
      vNodeList: { type: Array, default: [] },
      tupleItemsLength: { type: Number, default: 0 },
      addable: { type: Boolean, default: !0 },
      showIndexNumber: { type: Boolean, default: !1 },
      sortable: { type: Boolean, default: !0 },
      removable: { type: Boolean, default: !0 },
      maxItems: {},
      minItems: {},
      globalOptions: null,
    },
    setup: function (t, a) {
      var n = a.emit,
        o = r(function () {
          var e = t.addable,
            r = t.maxItems,
            a = t.vNodeList;
          return !!e && (void 0 !== r ? a.length < r : !!r);
        }),
        i = r(function () {
          var e = t.removable,
            r = t.minItems,
            a = t.vNodeList;
          return !!e && (void 0 === r || a.length > r);
        });
      return function () {
        return t.vNodeList.length <= 0 && !t.addable
          ? null
          : e(
              "div",
              { class: { arrayOrderList: !0 } },
              e(
                "div",
                { class: { arrayOrderListContent: !0 } },
                t.vNodeList.map(function (r, a) {
                  var u = r.key,
                    l = r.vNode,
                    c = t.tupleItemsLength + a,
                    s = a + 1;
                  return e(
                    "div",
                    { key: u, class: { arrayOrderList_item: !0 } },
                    [
                      t.showIndexNumber
                        ? e("div", { class: { arrayListItem_index: !0 } }, s)
                        : null,
                      e(
                        "div",
                        {
                          style: ue(
                            {},
                            t.sortable && a !== t.vNodeList.length - 1
                              ? {}
                              : { display: "none" },
                          ),
                          class: { arrayListItem_operateTool: !0 },
                        },
                        [
                          e(
                            "button",
                            {
                              style: ue(
                                {},
                                t.sortable ? {} : { display: "none" },
                              ),
                              class: {
                                arrayListItem_btn: !0,
                                "arrayListItem_orderBtn-top": !0,
                              },
                              type: "button",
                              disabled: !t.sortable || 0 === a,
                              onClick: function () {
                                n("arrayOperate", {
                                  command: "moveUp",
                                  data: { index: c },
                                });
                              },
                            },
                            [e(Y)],
                          ),
                          e(
                            "button",
                            {
                              style: ue(
                                {},
                                t.sortable ? {} : { display: "none" },
                              ),
                              class: {
                                arrayListItem_btn: !0,
                                "arrayListItem_orderBtn-bottom": !0,
                              },
                              type: "button",
                              disabled:
                                !t.sortable || a === t.vNodeList.length - 1,
                              onClick: function () {
                                n("arrayOperate", {
                                  command: "moveDown",
                                  data: { index: c },
                                });
                              },
                            },
                            [e(H)],
                          ),
                          e(
                            "button",
                            {
                              style: ue(
                                {},
                                t.removable ? {} : { display: "none" },
                              ),
                              class: {
                                arrayListItem_btn: !0,
                                "arrayListItem_btn-delete": !0,
                              },
                              type: "button",
                              disabled: !i.value,
                              onClick: function () {
                                n("arrayOperate", {
                                  command: "remove",
                                  data: { index: c },
                                });
                              },
                            },
                            [e(K)],
                          ),
                        ],
                      ),
                      e(
                        "div",
                        ue(
                          ue({}, o.value ? {} : { paddingTop: "0px" }),
                          {},
                          { class: { arrayListItem_content: !0 } },
                        ),
                        [l],
                      ),
                    ],
                  );
                }),
              ),
              e(
                "div",
                {
                  style: ue({}, o.value ? {} : { display: "none" }),
                  class: { arrayOrderList_bottomAddBtn: !0 },
                },
                [
                  e(
                    "div",
                    {
                      class: {
                        bottomAddBtn: !0,
                        "is-plain": !0,
                        genFormBtn: !0,
                        "addOption-btn": !0,
                      },
                      onClick: function () {
                        n("arrayOperate", { command: "add" });
                      },
                    },
                    [
                      e(Z, { style: { marginRight: "5px" } }),
                      t.maxItems
                        ? "添加更多("
                            .concat(t.vNodeList.length, " / ")
                            .concat(t.maxItems ? t.maxItems : "∞", ")")
                        : "",
                    ],
                  ),
                ],
              ),
            );
      };
    },
  },
  De = {
    name: "ArrayFieldNormal",
    props: ue(ue({}, ve), {}, { itemsFormData: { type: Array } }),
    setup: function (t, r) {
      var a = r.attrs;
      return function () {
        var r = t.schema,
          n = t.uiSchema,
          o = t.curNodePath,
          i = t.rootFormData,
          u = t.itemsFormData,
          l = t.errorSchema,
          c = t.globalOptions,
          s = A({ schema: r, uiSchema: n, curNodePath: o, rootFormData: i }),
          m = s.title,
          d = s.description,
          p = s.addable,
          f = s.showIndexNumber,
          h = s.sortable,
          y = s.removable,
          b = s.showTitle,
          g = s.showDescription,
          O = s.fieldClass,
          S = s.fieldAttrs,
          P = s.fieldStyle,
          F = u.map(function (a, i) {
            var u = L({ schema: r.items, uiSchema: n.items }, i);
            return {
              key: a.key,
              vNode: e(
                Ie,
                ue(
                  ue({ key: a.key }, t),
                  {},
                  {
                    schema: r.items,
                    required: ![].concat(r.items.type).includes("null"),
                    uiSchema: ue(ue({}, n.items), u),
                    errorSchema: l.items,
                    curNodePath: v(o, i),
                  },
                ),
              ),
            };
          });
        return e(
          G,
          {
            title: m,
            description: d,
            showTitle: b,
            showDescription: g,
            curNodePath: o,
            class: O,
            attrs: S,
            style: P,
          },
          {
            default: function () {
              return e(
                Fe,
                ue(
                  ue({}, a),
                  {},
                  {
                    vNodeList: F,
                    showIndexNumber: f,
                    addable: p,
                    sortable: h,
                    removable: y,
                    maxItems: r.maxItems || r.maxUniqueItems,
                    minItems: r.minItems || r.minUniqueItems,
                    globalOptions: c,
                  },
                ),
              );
            },
          },
        );
      };
    },
  },
  ke = {
    name: "ArrayFieldMultiSelect",
    props: ue({}, ve),
    setup: function (t, r) {
      var a = r.attrs;
      return function () {
        var r = t.schema,
          n = t.rootSchema,
          o = t.uiSchema,
          i = t.curNodePath,
          u = t.rootFormData,
          l = t.globalOptions,
          c = $(r.items, n),
          s = W(c, o, i, u),
          m = C(
            { schema: r, uiSchema: o, curNodePath: i, rootFormData: u },
            function () {
              return { widget: l.WIDGET_MAP.common.checkboxGroup };
            },
          );
        return (
          (m.uiProps.multiple = !0),
          s && !m.uiProps.enumOptions && (m.uiProps.enumOptions = s),
          e(ye, ue(ue(ue({}, a), t), m))
        );
      };
    },
  },
  je = {
    name: "ArrayFieldTuple",
    props: ue(
      ue({}, ve),
      {},
      {
        itemsFormData: {
          type: Array,
          default: function () {
            return [];
          },
        },
      },
    ),
    emits: ["arrayOperate"],
    setup: function (t, r) {
      var a = r.emit;
      r.attrs;
      return (
        (function () {
          var e = !Array.isArray(t.itemsFormData);
          if (e || t.itemsFormData.length < t.schema.items.length) {
            var r = S(t.schema, void 0, t.rootSchema);
            a(
              "arrayOperate",
              e
                ? { command: "setNewTarget", data: { newTarget: r } }
                : {
                    command: "batchPush",
                    data: { pushArray: r.slice(t.itemsFormData.length) },
                  },
            );
          }
        })(),
        function () {
          if (!Array.isArray(t.itemsFormData)) return null;
          var r = t.schema,
            n = t.uiSchema,
            o = t.errorSchema,
            i = t.curNodePath,
            u = t.globalOptions,
            l = A({
              schema: r,
              uiSchema: n,
              curNodePath: i,
              rootFormData: t.rootFormData,
            }),
            c = l.title,
            s = l.description,
            m = l.addable,
            d = l.showIndexNumber,
            p = l.sortable,
            f = l.removable,
            h = l.showTitle,
            y = l.showDescription,
            b = l.fieldClass,
            g = l.fieldAttrs,
            O = l.fieldStyle,
            S = te(t.itemsFormData, t.schema.items.length - 1),
            P = S[0].map(function (a, u) {
              return e(
                Ie,
                ue(
                  ue({ key: a.key }, t),
                  {},
                  {
                    required: ![].concat(r.items[u].type).includes("null"),
                    schema: r.items[u],
                    uiSchema: n.items ? n.items[u] : {},
                    errorSchema: o.items ? o.items[u] : {},
                    curNodePath: v(i, u),
                  },
                ),
              );
            }),
            F = S[1].map(function (a, i) {
              var u = L(
                { schema: r.additionalItems, uiSchema: n.additionalItems },
                i,
              );
              return {
                key: a.key,
                vNode: e(
                  Ie,
                  ue(
                    ue({ key: a.key }, t),
                    {},
                    {
                      schema: r.additionalItems,
                      required: ![]
                        .concat(r.additionalItems.type)
                        .includes("null"),
                      uiSchema: ue(ue({}, n.additionalItems), u),
                      errorSchema: o.additionalItems,
                      curNodePath: v(t.curNodePath, i + r.items.length),
                    },
                  ),
                ),
              };
            }),
            D = (void 0 === m || m) && M(t.schema);
          return e(
            G,
            ue(
              ue(
                {
                  title: c,
                  description: s,
                  showTitle: h,
                  showDescription: y,
                  curNodePath: i,
                },
                g,
              ),
              {},
              { class: b, style: O },
            ),
            {
              default: function () {
                return [].concat(se(P), [
                  e(Fe, {
                    onArrayOperate: function () {
                      for (
                        var e = arguments.length, t = new Array(e), r = 0;
                        r < e;
                        r++
                      )
                        t[r] = arguments[r];
                      return a.apply(void 0, ["arrayOperate"].concat(t));
                    },
                    vNodeList: F,
                    tupleItemsLength: r.items.length,
                    addable: D,
                    showIndexNumber: d,
                    sortable: p,
                    removable: f,
                    maxItems: r.maxItems || r.maxUniqueItems,
                    minItems: r.minItems || r.minUniqueItems,
                    globalOptions: u,
                  }),
                ]);
              },
            },
          );
        }
      );
    },
  },
  we = {
    name: "ArrayFieldSpecialFormat",
    props: ve,
    setup: function (t, a) {
      var n = a.attrs,
        o = r(function () {
          return C({
            schema: ue(
              {
                "ui:widget":
                  t.globalOptions.WIDGET_MAP.formats[t.schema.format],
              },
              t.schema,
            ),
            uiSchema: t.uiSchema,
            curNodePath: t.curNodePath,
            rootFormData: t.rootFormData,
          });
        });
      return function () {
        return e(ye, ue(ue(ue({}, n), t), o.value));
      };
    },
  },
  Ne = {
    name: "ArrayField",
    props: ve,
    setup: function (t) {
      var i = this,
        u = function () {
          var e = t.rootFormData,
            r = t.curNodePath,
            a = d(e, r);
          return Array.isArray(a) ? a : [];
        },
        l = a(
          u().map(function () {
            return F();
          }),
        ),
        c = r(function () {
          return u();
        });
      n(
        c,
        function (e, t) {
          e !== t &&
            o(e) !== o(t) &&
            Array.isArray(e) &&
            (l.value = e.map(function () {
              return F();
            }));
        },
        { deep: !0 },
      );
      var s = r(function () {
          return c.value.map(function (e, t) {
            return { key: l.value[t], value: e };
          });
        }),
        m = r(function () {
          return _({
            schema: t.schema,
            uiSchema: t.uiSchema,
            curNodePath: t.curNodePath,
            rootFormData: t.rootFormData,
          });
        }),
        f = function (e) {
          var r = e.command,
            a = e.data,
            n = {
              moveUp: function (e, t) {
                var r = t.index;
                re(e, r);
              },
              moveDown: function (e, t) {
                var r = t.index;
                ae(e, r);
              },
              remove: function (e, t) {
                var r = t.index;
                ne(e, r);
              },
              add: function (e, t) {
                var r = t.newRowData;
                e.unshift(r);
              },
              batchPush: function (e, t) {
                t.pushArray.forEach(function (t) {
                  e.unshift(t);
                });
              },
              setNewTarget: function (e, t) {
                var r = t.formData,
                  a = t.nodePath,
                  n = t.newTarget;
                p(r, a, n);
              },
            }[r];
          if (!n) throw new Error("错误 - 未知的操作：[".concat(r, "]"));
          var o,
            u,
            s,
            d = a,
            f = a;
          "add" === r
            ? ((d = {
                newRowData:
                  ((o = t.schema),
                  (u = t.rootSchema),
                  (s = o.items),
                  E(o) && M(o) && (s = o.additionalItems),
                  S(s, void 0, u)),
              }),
              (f = { newRowData: F() }))
            : "batchPush" === r
              ? (f = {
                  pushArray: d.pushArray.map(function (e) {
                    return F();
                  }),
                })
              : "setNewTarget" === r &&
                ((d = {
                  formData: t.rootFormData,
                  nodePath: t.curNodePath,
                  newTarget: d.newTarget,
                }),
                (f = {
                  formData: l,
                  nodePath: "value",
                  newTarget: d.newTarget.map(function (e) {
                    return F();
                  }),
                })),
            n.apply(null, [l.value, f]),
            n.apply(null, [c.value, d]),
            m.value.afterArrayOperate &&
              i.uiOptions.afterArrayOperate.call(null, c.value, r, a);
        };
      return function () {
        var r = t.schema,
          a = t.uiSchema,
          n = t.rootSchema,
          o = t.rootFormData,
          i = t.curNodePath,
          u = t.globalOptions;
        if (!r.hasOwnProperty("items"))
          throw new Error("[".concat(r, "] 请先定义 items属性"));
        if (B(r, n))
          return e(ke, ue(ue({}, t), {}, { class: oe({}, D(ke.name), !0) }));
        if (r.format || r["ui:widget"] || a["ui:widget"])
          return e(we, ue(ue({}, t), {}, { class: oe({}, D(we.name), !0) }));
        var l = E(r) ? je : De;
        return e("div", [
          e(
            l,
            ue(
              ue({ itemsFormData: s.value }, t),
              {},
              { onArrayOperate: f, class: oe({}, D(l.name), !0) },
            ),
          ),
          t.needValidFieldGroup
            ? e(ye, {
                key: "validateWidget-array",
                class: { validateWidget: !0, "validateWidget-array": !0 },
                schema: Object.entries(r).reduce(function (e, t) {
                  var r = ce(t, 2),
                    a = r[0],
                    n = r[1];
                  return "items" !== a && (e[a] = n), e;
                }, {}),
                uiSchema: a,
                errorSchema: t.errorSchema,
                curNodePath: i,
                rootFormData: o,
                globalOptions: u,
              })
            : null,
        ]);
      };
    },
  },
  xe = {
    name: "SelectLinkageField",
    props: ue(
      ue({}, ve),
      {},
      {
        combiningType: { type: String, default: "anyOf" },
        selectList: { type: Array, require: !0 },
      },
    ),
    setup: function (t) {
      var r,
        o = a(
          ((r = d(t.rootFormData, t.curNodePath)),
          X(r, t.selectList, t.rootSchema, !0) || 0),
        ),
        i = function () {
          var r,
            a = C(
              {
                schema: t.schema["".concat(t.combiningType, "Select")] || {},
                uiSchema:
                  t.uiSchema["".concat(t.combiningType, "Select")] || {},
                curNodePath: t.curNodePath,
                rootFormData: t.rootFormData,
              },
              function () {
                return { widget: "SelectWidget" };
              },
            );
          if (
            ((a.label = a.label || t.schema.title),
            (a.description = a.description || t.schema.description),
            !a.uiProps.enumOptions)
          ) {
            var n = t.uiSchema[t.combiningType] || [];
            a.uiProps.enumOptions = t.selectList.map(function (e, r) {
              var a = A({ schema: e, uiSchema: n[r], containsSpec: !1 }),
                o = "";
              return (
                "anyOf" === t.combiningType
                  ? (o = 0 === r ? "自定义输入" : "固有选项")
                  : "oneOf" === t.combiningType &&
                    (o = 0 === r ? "日期" : "日期（时分秒）"),
                { label: a.title || o, value: r }
              );
            });
          }
          return e(
            ye,
            ue(
              ue(
                {
                  key: "fieldSelect_".concat(t.combiningType),
                  class:
                    ((r = {}),
                    oe(r, "fieldSelect_".concat(t.combiningType), !0),
                    oe(r, "Custom_Options", !0),
                    r),
                  isFormData: !1,
                  curValue: o.value,
                  curNodePath: t.curNodePath,
                  rootFormData: t.rootFormData,
                  globalOptions: t.globalOptions,
                },
                a,
              ),
              {},
              {
                onOtherDataChange: function (e) {
                  o.value = e;
                },
              },
            ),
          );
        };
      return (
        n(o, function (e, r) {
          var a = d(t.rootFormData, t.curNodePath),
            n = S(t.selectList[e], void 0, t.rootSchema),
            o = Object.prototype.hasOwnProperty;
          if (P(a)) {
            var i = $(t.selectList[r], t.rootSchema);
            if ("object" === k(i))
              for (var u in i.properties)
                o.call(i.properties, u) && !o.call(n, u) && y(a, u);
          }
          P(n)
            ? Object.entries(n).forEach(function (r) {
                var n,
                  o = ce(r, 2),
                  i = o[0],
                  u = o[1];
                void 0 === u ||
                  (void 0 !== a[i] &&
                    !P(u) &&
                    void 0 ===
                      (null ===
                        (n = $(t.selectList[e], t.rootSchema).properties[i]) ||
                      void 0 === n
                        ? void 0
                        : n.const)) ||
                  p(a, i, u);
              })
            : p(
                t.rootFormData,
                t.curNodePath,
                void 0 === n && Q($(t.selectList[e], t.rootSchema), a) ? a : n,
              );
        }),
        function () {
          var r,
            a = t.curNodePath,
            n = b(a),
            u = "object" === t.schema.type || t.schema.properties,
            l = [i()],
            c = t.selectList[o.value];
          if (c) {
            var s = t.schema,
              m = t.combiningType,
              d = "".concat(t.combiningType, "Select");
            s.properties, s[m], s[d];
            var p = le(s, ["properties", m, d].map(pe));
            c = Object.assign({}, p, c);
          }
          var f = u && j(c && c.properties);
          if (c && !f) {
            var h = w(
                A({
                  schema: t.schema,
                  uiSchema: t.uiSchema,
                  containsSpec: !1,
                  curNodePath: a,
                  rootFormData: t.rootFormData,
                }),
                function (e) {
                  return e === t.combiningType ? void 0 : "ui:".concat(e);
                },
              ),
              v = w(
                V({
                  schema: t.schema,
                  uiSchema: t.uiSchema,
                  errorSchema: t.errorSchema,
                }),
                function (e) {
                  return e === t.combiningType ? void 0 : "err:".concat(e);
                },
              );
            l.unshift(
              e(
                Ie,
                ue(
                  ue({ key: "appendSchema_".concat(t.combiningType) }, t),
                  {},
                  {
                    schema: ue(
                      { "ui:showTitle": !1, "ui:showDescription": !1 },
                      c,
                    ),
                    required: t.required,
                    uiSchema: ue(
                      ue({}, h),
                      (t.uiSchema[t.combiningType] || [])[o.value],
                    ),
                    errorSchema: ue(
                      ue({}, v),
                      (t.errorSchema[t.combiningType] || [])[o.value],
                    ),
                  },
                ),
              ),
            );
          }
          var y = null;
          if (u && !j(t.schema.properties)) {
            var g,
              O = c;
            O.title, O.description, O.properties;
            var S = le(O, ["title", "description", "properties"]),
              P = Object.assign({}, t.schema, S);
            delete P[t.combiningType],
              (y = e(
                Ie,
                ue(
                  ue(
                    {
                      key: "origin_".concat(t.combiningType),
                      class:
                        ((g = {}),
                        oe(g, "".concat(t.combiningType, "_originBox"), !0),
                        oe(g, "".concat(n, "-originBox"), !0),
                        g),
                    },
                    t,
                  ),
                  {},
                  { schema: P },
                ),
              ));
          }
          return (
            l.unshift(
              e(ye, {
                key: "validateWidget-".concat(t.combiningType),
                class: oe(
                  { validateWidget: !0 },
                  "validateWidget-".concat(t.combiningType),
                  !0,
                ),
                schema: t.schema,
                uiSchema: t.uiSchema,
                errorSchema: t.errorSchema,
                curNodePath: t.curNodePath,
                rootFormData: t.rootFormData,
                globalOptions: t.globalOptions,
              }),
            ),
            e("div", [
              y,
              e(
                "div",
                {
                  key: "appendBox_".concat(t.combiningType),
                  class:
                    ((r = { appendCombining_box: !0 }),
                    oe(r, "".concat(t.combiningType, "_appendBox"), !0),
                    oe(r, "".concat(n, "-appendBox"), !0),
                    r),
                },
                l,
              ),
            ])
          );
        }
      );
    },
  },
  Ae = {
    array: Ne,
    boolean: Pe,
    integer: Se,
    number: Oe,
    object: be,
    string: ge,
    null: {
      render: function () {
        return null;
      },
    },
    anyOf: {
      name: "AnyOfField",
      setup: function (t, r) {
        var a = r.attrs,
          n = r.slots;
        return function () {
          return e(
            xe,
            ue(
              ue({}, a),
              {},
              { combiningType: "anyOf", selectList: a.schema.anyOf },
            ),
            n,
          );
        };
      },
    },
    oneOf: {
      name: "oneOfField",
      setup: function (t, r) {
        var a = r.attrs,
          n = r.slots;
        return function () {
          return e(
            xe,
            ue(
              ue({}, a),
              {},
              { combiningType: "oneOf", selectList: a.schema.oneOf },
            ),
            n,
          );
        };
      },
    },
  },
  Ie = {
    name: "SchemaField",
    props: ve,
    setup: function (t) {
      return function () {
        var r,
          a = $(t.schema, t.rootSchema),
          n = ue(ue({}, t), {}, { schema: a });
        if (0 === Object.keys(a).length) return null;
        var o,
          i,
          u = R(Ae, n),
          l = u.field,
          c = u.fieldProps,
          s = q({
            schema: a,
            uiSchema: t.uiSchema,
            curNodePath: t.curNodePath,
            rootFormData: t.rootFormData,
          }),
          d = b(t.curNodePath);
        return a.anyOf && a.anyOf.length > 0 && !T(a)
          ? e(
              m(Ae.anyOf),
              ue(
                {
                  class:
                    ((o = {}),
                    oe(o, "".concat(d, "-anyOf"), !0),
                    oe(o, "fieldItem", !0),
                    oe(o, "anyOfField", !0),
                    o),
                },
                n,
              ),
            )
          : a.oneOf && a.oneOf.length > 0 && !T(a)
            ? e(
                m(Ae.oneOf),
                ue(
                  {
                    class:
                      ((i = {}),
                      oe(i, "".concat(d, "-oneOf"), !0),
                      oe(i, "fieldItem", !0),
                      oe(i, "oneOfField", !0),
                      i),
                  },
                  n,
                ),
              )
            : l && !s
              ? e(
                  m(l),
                  ue(
                    ue({}, n),
                    {},
                    {
                      fieldProps: c,
                      class:
                        ((r = {}),
                        oe(r, D(l.name) || l, !0),
                        oe(r, "hiddenWidget", s),
                        oe(r, "fieldItem", !0),
                        oe(r, d, !0),
                        r),
                    },
                  ),
                )
              : null;
      };
    },
  };
function Te() {
  var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
    o = {
      name: "VueForm",
      props: fe,
      emits: [
        "update:modelValue",
        "change",
        "cancel",
        "submit",
        "validation-failed",
        "form-mounted",
      ],
      setup: function (c, s) {
        var d = s.slots,
          p = s.emit,
          f = i();
        !o.installed &&
          t.WIDGET_MAP.widgetComponents &&
          (Object.entries(t.WIDGET_MAP.widgetComponents).forEach(function (e) {
            var t = ce(e, 2),
              r = t[0],
              a = t[1];
            return f.appContext.app.component(r, a);
          }),
          (o.installed = !0));
        var h = u(c, "fallbackLabel");
        l("genFormProvide", { fallbackLabel: h });
        var v = a(S(c.schema, c.modelValue, c.schema, c.strictMode)),
          y = r(function () {
            return ue(
              { show: !0, okBtn: "保存", okBtnProps: {}, cancelBtn: "取消" },
              c.formFooter,
            );
          }),
          b = null,
          g = function (e, t) {
            p("update:modelValue", e),
              p("change", { newValue: e, oldValue: t });
          },
          O = function (e, t) {
            if (!N(e, t)) {
              var r = S(c.schema, c.modelValue, c.schema, c.strictMode);
              N(v.value, r) || (v.value = r);
            }
          };
        n(
          v,
          function (e, t) {
            g(e, t);
          },
          { deep: !0 },
        ),
          n(
            function () {
              return c.schema;
            },
            function (e, t) {
              O(e, t);
            },
          ),
          n(
            function () {
              return c.modelValue;
            },
            function (e, t) {
              O(e, t);
            },
          ),
          g(v.value, c.modelValue);
        return function () {
          var r,
            a = c.formProps,
            n = a.layoutColumn,
            o = void 0 === n ? 1 : n,
            i = a.inlineFooter;
          a.labelSuffix, a.isMiniDes, a.defaultSelectFirstOption, a.popover;
          var u = le(a, [
              "layoutColumn",
              "inlineFooter",
              "labelSuffix",
              "isMiniDes",
              "defaultSelectFirstOption",
              "popover",
            ]),
            l = u.inline,
            s = void 0 !== l && l,
            h = u.labelPosition,
            g = void 0 === h ? "top" : h,
            O = {
              schema: c.schema,
              uiSchema: c.uiSchema,
              errorSchema: c.errorSchema,
              customFormats: c.customFormats,
              customRule: c.customRule,
              rootSchema: c.schema,
              rootFormData: v.value,
              curNodePath: "",
              globalOptions: t,
              formProps: ue(
                {
                  labelPosition: g,
                  labelSuffix: "：",
                  defaultSelectFirstOption: !0,
                  inline: s,
                },
                c.formProps,
              ),
            };
          return e(
            m(t.COMPONENT_MAP.form),
            ue(
              {
                class:
                  ((r = {
                    genFromComponent: !0,
                    formInlineFooter: i,
                    formInline: s,
                  }),
                  oe(
                    r,
                    "genFromComponent_".concat(c.schema.id, "Form"),
                    !!c.schema.id,
                  ),
                  oe(r, "layoutColumn", !s),
                  oe(r, "layoutColumn-".concat(o), !s),
                  r),
                setFormRef: function (e) {
                  (b = e),
                    (f.ctx.$$uiFormRef = b),
                    p("form-mounted", e, { formData: v.value });
                },
                onSubmit: function (e) {
                  e.preventDefault();
                },
                model: v,
                labelPosition: g,
                inline: s,
              },
              u,
            ),
            {
              default: function () {
                return [
                  e(Ie, O),
                  d.default
                    ? d.default({
                        formData: v,
                        formRefFn: function () {
                          return b;
                        },
                      })
                    : y.value.show
                      ? e(he, {
                          globalOptions: t,
                          okBtn: y.value.okBtn,
                          okBtnProps: y.value.okBtnProps,
                          cancelBtn: y.value.cancelBtn,
                          formItemAttrs: y.value.formItemAttrs,
                          onCancel: function () {
                            p("cancel");
                          },
                          onSubmit: function () {
                            (b.$$validate || b.validate)(function (e, t) {
                              return e
                                ? p("submit", v)
                                : p("validation-failed", t);
                            });
                          },
                        })
                      : [],
                ];
              },
            },
          );
        };
      },
      install: function (e) {
        var t =
          arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};
        e.component(t.name || o.name, o);
      },
    };
  return o;
}
var We = {
    $$currentLocalizeFn: function (e) {
      if (e && e.length)
        for (var t = 0; t < e.length; t += 1) {
          var r = e[t],
            a = void 0,
            n = void 0,
            o = void 0;
          console.log(r);
          
          switch (r.keyword) {
            case "$ref":
              a = "无法找到引用".concat(r.params.ref);
              break;
            case "additionalItems":
              (a = ""),
                (n = r.params.limit),
                (a += "不允许超过".concat(n, "个元素"));
              break;
            case "additionalProperties":
              a = "不允许有额外的属性";
              break;
            case "anyOf":
              a = "数据应为 anyOf 所指定的其中一个";
              break;
            case "const":
              a = "应当等于常量";
              break;
            case "contains":
              a = "应当包含一个有效项";
              break;
            case "custom":
              a = '应当通过 "'.concat(r.keyword, ' 关键词校验"');
              break;
            case "dependencies":
              (a = ""),
                (n = r.params.depsCount),
                (a += "应当拥有属性"
                  .concat(r.params.property, "的依赖属性")
                  .concat(r.params.deps));
              break;
            case "enum":
              a = "应当是预设定的枚举值之一";
              break;
            case "exclusiveMaximum":
            case "exclusiveMinimum":
              (a = ""),
                (o = ""
                  .concat(r.params.comparison, " ")
                  .concat(r.params.limit)),
                (a += "应当为 ".concat(o));
              break;
            case "false schema":
              a = "布尔模式出错";
              break;
            case "format":
              a = '应当匹配格式 "'.concat(r.params.format, '"');
              break;
            case "formatExclusiveMaximum":
              a = "formatExclusiveMaximum 应当是布尔值";
              break;
            case "formatExclusiveMinimum":
              a = "formatExclusiveMinimum 应当是布尔值";
              break;
            case "formatMaximum":
            case "formatMinimum":
              (a = ""),
                (o = ""
                  .concat(r.params.comparison, " ")
                  .concat(r.params.limit)),
                (a += "应当是 ".concat(o));
              break;
            case "if":
              a = '应当匹配模式 "'.concat(r.params.failingKeyword, '" ');
              break;
            case "maximum":
              (a = ""),
                (o = ""
                  .concat(r.params.comparison, " ")
                  .concat(r.params.limit)),
                (a += "应当为 ".concat(o));
              break;
            case "maxItems":
              (a = ""),
                (n = r.params.limit),
                (a += "不应多于 ".concat(n, " 个项"));
              break;
            case "maxLength":
              (a = ""),
                (n = r.params.limit),
                (a += "不应多于 ".concat(n, " 个字符"));
              break;
            case "maxProperties":
              (a = ""),
                (n = r.params.limit),
                (a += "不应有多于 ".concat(n, " 个属性"));
              break;
            case "minimum":
              (a = ""),
                (o = ""
                  .concat(r.params.comparison, " ")
                  .concat(r.params.limit)),
                (a += "应当为 ".concat(o));
              break;
            case "minItems":
              (a = ""),
                (n = r.params.limit),
                (a += "不应少于 ".concat(n, " 个项"));
              break;
            case "minLength":
              (a = ""),
                (n = r.params.limit),
                (a += "不应少于 ".concat(n, " 个字符"));
              break;
            case "minProperties":
              (a = ""),
                (n = r.params.limit),
                (a += "不应有少于 ".concat(n, " 个属性"));
              break;
            case "multipleOf":
              a = "应当是 ".concat(r.params.multipleOf, " 的整数倍");
              break;
            case "not":
              a = '不应当匹配 "not" schema';
              break;
            case "oneOf":
              a = '只能匹配一个 "oneOf" 中的 schema';
              break;
            case "pattern":
              a = '应当匹配模式 "'.concat(r.params.pattern, '"');
              break;
            case "patternRequired":
              a = "应当有属性匹配模式 ".concat(r.params.missingPattern);
              break;
            case "propertyNames":
              a = "属性名 '".concat(r.params.propertyName, "' 无效");
              break;
            case "required":
              a = "应当有必需属性 ".concat(r.params.propertyNames);
              break;
            case "switch":
              a = "由于 ".concat(
                r.params.caseIndex,
                ' 失败，未通过 "switch" 校验, ',
              );
              break;
            case "type":
              a = "应当是 ".concat(r.params.type, " 类型");
              break;
            case "uniqueItems":
              a = "不应当含有重复项 (第 "
                .concat(r.params.j, " 项与第 ")
                .concat(r.params.i, " 项是重复的)");
              break;
            default:
              continue;
          }
          r.message = a;
        }
    },
    getCurrentLocalize: function () {
      return this.$$currentLocalizeFn;
    },
    useLocal: function (e) {
      this.$$currentLocalizeFn = e;
    },
  },
  Ce = function (t) {
    return c({
      inheritAttrs: !1,
      setup: function (r, a) {
        var n = a.attrs,
          o = a.slots;
        return function () {
          var r = n.isNumberValue,
            a = n.isRange,
            i = n.value,
            u = le(n, ["isNumberValue", "isRange", "value"]),
            l = r
              ? a
                ? (i || []).map(function (e) {
                    return "number" == typeof e ? String(e) : e;
                  })
                : "number" == typeof i
                  ? String(i)
                  : i
              : i,
            c = ue(
              ue({}, n),
              {},
              {
                value: l,
                "onUpdate:value": function (e) {
                  r &&
                    (e = a
                      ? e.map(function (e) {
                          return +e;
                        })
                      : +e),
                    u["onUpdate:value"].call(this, e);
                },
              },
            );
          return e(m(t), c, o);
        };
      },
    });
  },
  Le = g(
    {
      name: "CheckboxesWidget",
      props: {
        enumOptions: {
          default: function () {
            return [];
          },
          type: [Array],
        },
      },
      setup: function (t, r) {
        var a = r.attrs;
        return function () {
          return e(m("a-checkbox-group"), a, {
            default: function () {
              return t.enumOptions.map(function (t, r) {
                return e(
                  m("a-checkbox"),
                  { key: r, value: t.value },
                  {
                    default: function () {
                      return t.label;
                    },
                  },
                );
              });
            },
          });
        };
      },
    },
    { model: "value" },
  ),
  Me = g(
    {
      name: "RadioWidget",
      props: {
        enumOptions: {
          default: function () {
            return [];
          },
          type: [Array],
        },
      },
      setup: function (t, r) {
        var a = r.attrs;
        return function () {
          return e(m("a-radio-group"), a, {
            default: function () {
              return t.enumOptions.map(function (t, r) {
                return e(
                  m("a-radio"),
                  { key: r, value: t.value },
                  {
                    default: function () {
                      return t.label;
                    },
                  },
                );
              });
            },
          });
        };
      },
    },
    { model: "value" },
  );
function _e(e, t) {
  return t.key.indexOf(e) >= 0;
}
var Be = g(
    {
      name: "SelectWidget",
      props: {
        enumOptions: {
          default: function () {
            return [];
          },
          type: [Array],
        },
      },
      setup: function (t, r) {
        var a,
          n = r.attrs,
          o = !0;
        return (
          t.enumOptions.length > 0 &&
            ((a = t.enumOptions),
            (o = !(
              ["自定义输入", "日期"].includes(a[0].label) &&
              0 === a[0].value &&
              ["固有选项", "日期（时分秒）"].includes(a[1].label) &&
              1 === a[1].value
            ))),
          function () {
            return e(
              m("a-select"),
              ue(
                ue(ue({}, n.multiple ? { mode: "multiple" } : {}), n),
                {},
                { showSearch: o, filterOption: _e, allowClear: o },
              ),
              {
                default: function () {
                  return t.enumOptions.map(function (t, r) {
                    return e(
                      m("a-select-option"),
                      { key: t.label, value: t.value },
                      {
                        default: function () {
                          return t.label;
                        },
                      },
                    );
                  });
                },
              },
            );
          }
        );
      },
    },
    { model: "value" },
  ),
  Ee = g(
    Ce({
      name: "DatePickerWidget",
      inheritAttrs: !1,
      setup: function (t, r) {
        var a = r.attrs;
        return function () {
          var t = a.isNumberValue,
            r = a.isRange,
            n = le(a, ["isNumberValue", "isRange"]);
          return e(
            m(r ? "a-range-picker" : "a-date-picker"),
            ue({ valueFormat: t ? "x" : "YYYY-MM-DD" }, n),
          );
        };
      },
    }),
    { model: "value" },
  ),
  Ve = g(
    Ce({
      name: "DatePickerWidget",
      inheritAttrs: !1,
      setup: function (t, r) {
        var a = r.attrs;
        return function () {
          var t = a.isNumberValue,
            r = a.isRange,
            n = le(a, ["isNumberValue", "isRange"]);
          return e(
            m(r ? "a-range-picker" : "a-date-picker"),
            ue(
              { valueFormat: t ? "x" : "YYYY-MM-DDTHH:mm:ssZ", showTime: !0 },
              n,
            ),
          );
        };
      },
    }),
    { model: "value" },
  ),
  Re = {
    CheckboxesWidget: Le,
    RadioWidget: Me,
    SelectWidget: Be,
    TimePickerWidget: g(
      {
        name: "TimePickerWidget",
        inheritAttrs: !1,
        setup: function (t, r) {
          var a = r.attrs;
          return function () {
            return e(m("a-time-picker"), ue({ "value-format": "HH:mm:ss" }, a));
          };
        },
      },
      { model: "value" },
    ),
    DatePickerWidget: Ee,
    DateTimePickerWidget: Ve,
    UploadWidget: {
      name: "UploadWidget",
      props: {
        modelValue: { default: null, type: [String, Array] },
        responseFileUrl: {
          default: function () {
            return function (e) {
              return e ? e.url || (e.data && e.data.url) : "";
            };
          },
          type: [Function],
        },
        btnText: { type: String, default: "点击上传" },
        slots: { type: null, default: null },
      },
      inheritAttrs: !1,
      setup: function (t, r) {
        var n = r.attrs,
          o = r.emit,
          i = t.modelValue,
          u = Array.isArray(i),
          l =
            n.fileList ||
            (u
              ? i.map(function (e, t) {
                  return {
                    uid: String(t),
                    status: "done",
                    name: "已上传文件（".concat(t + 1, "）"),
                    url: e,
                  };
                })
              : i
                ? [{ uid: "1", status: "done", name: "已上传文件", url: i }]
                : []),
          c = a(l),
          s = function (e) {
            return (
              (e && ((e.response && t.responseFileUrl(e.response)) || e.url)) ||
              ""
            );
          };
        return function () {
          return e(
            m("a-upload"),
            ue(
              ue({}, n),
              {},
              {
                fileList: c.value,
                "onUpdate:fileList": function (e) {
                  c.value = e;
                },
                onChange: function (e) {
                  "uploading" !== e.file.status &&
                    (function (e) {
                      var t;
                      if (u)
                        t = e.length
                          ? e.reduce(function (e, t) {
                              var r = s(t);
                              return r && ((t.url = r), e.push(r)), e;
                            }, [])
                          : [];
                      else {
                        var r = e[e.length - 1];
                        (t = s(r)),
                          r && t
                            ? ((r.url = t), (c.value = [r]))
                            : (c.value = []);
                      }
                      o("update:modelValue", t);
                    })(e.fileList),
                    n.onChange && n.onChange.call(this, e);
                },
              },
            ),
            ue(
              {
                default: function () {
                  return e(
                    m("a-button"),
                    { type: "primary" },
                    {
                      default: function () {
                        return t.btnText;
                      },
                    },
                  );
                },
              },
              t.slots || {},
            ),
          );
        };
      },
    },
    InputWidget: g("a-input"),
    ColorWidget: {
      setup: function (t, r) {
        var a = r.attrs;
        return function () {
          return e(
            Re.InputWidget,
            ue(
              ue({}, a),
              {},
              { style: ue(ue({}, a.style || {}), {}, { maxWidth: "180px" }) },
            ),
            {
              addonAfter: function () {
                return e("input", {
                  disabled: a.disabled,
                  readonly: a.readonly,
                  value: a.modelValue,
                  onInput: function (e) {
                    a["onUpdate:modelValue"](e.target.value);
                  },
                  onChange: function (e) {
                    a["onUpdate:modelValue"](e.target.value);
                  },
                  type: "color",
                  style: { padding: "0", width: "50px" },
                });
              },
            },
          );
        };
      },
    },
    TextAreaWidget: g("a-textarea"),
    InputNumberWidget: g("a-input-number"),
    AutoCompleteWidget: g("a-auto-complete"),
    SliderWidget: g("a-slider"),
    RateWidget: g("a-rate"),
    SwitchWidget: g("a-switch", { model: "checked" }),
  },
  qe = Re.InputWidget,
  Ue = Re.InputNumberWidget,
  $e = Re.SwitchWidget,
  Ge = Re.CheckboxesWidget,
  ze = Re.RadioWidget,
  Ye = Re.SelectWidget,
  He = Re.TimePickerWidget,
  Ke = Re.DatePickerWidget,
  Ze = Re.DateTimePickerWidget,
  Je = {
    types: { boolean: $e, string: qe, number: Ue, integer: Ue },
    formats: { color: Re.ColorWidget, time: He, date: Ke, "date-time": Ze },
    common: { select: Ye, radioGroup: ze, checkboxGroup: Ge },
    widgetComponents: Re,
  };
!(function (e, t) {
  void 0 === t && (t = {});
  var r = t.insertAt;
  if (e && "undefined" != typeof document) {
    var a = document.head || document.getElementsByTagName("head")[0],
      n = document.createElement("style");
    (n.type = "text/css"),
      "top" === r && a.firstChild
        ? a.insertBefore(n, a.firstChild)
        : a.appendChild(n),
      n.styleSheet
        ? (n.styleSheet.cssText = e)
        : n.appendChild(document.createTextNode(e));
  }
})(
  ".genFromComponent.ant-form-vertical .ant-form-item-label{line-height:26px;padding-bottom:6px;font-size:14px}.genFromComponent .ant-form-item{margin-bottom:22px}.genFromComponent .ant-form-item.ant-form-item-with-help{margin-bottom:2px}.genFromComponent .ant-form-explain{padding-top:2px;display:-webkit-box!important;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;white-space:normal;text-align:left;line-height:1.2;font-size:12px}.genFromComponent .validateWidget .ant-form-explain{padding:5px 0;position:relative}.genFromComponent .ant-form-item-label>label.ant-form-item-no-colon:after{display:none}.genFromComponent .validateWidget>.ant-form-item{margin-bottom:0!important;padding:0!important}.genFromComponent .validateWidget>.ant-form-item .formItemErrorBox{padding:5px 0;position:relative}",
);
var Qe = {
    WIDGET_MAP: Je,
    COMPONENT_MAP: {
      form: c({
        inheritAttrs: !1,
        setup: function (t, r) {
          var n = r.attrs,
            o = r.slots,
            i = {
              top: { layout: "vertical" },
              left: { layout: "horizontal", labelAlign: "left" },
              right: { layout: "horizontal", labelAlign: "right" },
            },
            u = a(null);
          return (
            n.setFormRef &&
              s(function () {
                (u.value.$$validate = function (e) {
                  u.value
                    .validate()
                    .then(function (t) {
                      e(!0, t);
                    })
                    .catch(function (t) {
                      e(!1, t.errorFields);
                    });
                }),
                  n.setFormRef(u.value);
              }),
            function () {
              n.setFormRef;
              var t = n.labelPosition;
              n.labelWidth;
              var r = n.model,
                a = le(n, [
                  "setFormRef",
                  "labelPosition",
                  "labelWidth",
                  "model",
                ]);
              return (
                a.inline && Object.assign(a, { layout: "inline" }),
                e(
                  m("a-form"),
                  ue(
                    ue(ue({ ref: u, model: r.value }, i[t || "top"]), a),
                    {},
                    { colon: !1 },
                  ),
                  o,
                )
              );
            }
          );
        },
      }),
      formItem: c({
        inheritAttrs: !1,
        setup: function (t, r) {
          var n = r.attrs,
            o = r.slots,
            i = a(null);
          return function () {
            var t = n.prop,
              r = n.rules,
              a = n.description,
              u = le(n, ["prop", "rules", "description"]);
            return e(
              m("a-form-item"),
              ue(
                ue({}, u),
                {},
                {
                  ref: i,
                  tooltip: a || "",
                  rules: (r || []).map(function (e) {
                    return ue(
                      ue({}, e),
                      {},
                      {
                        validator: function (t, r) {
                          return e.validator.apply(this, [t, r]);
                        },
                      },
                    );
                  }),
                  name: t ? t.split(".") : t,
                },
              ),
              ue(
                ue({}, o),
                {},
                {
                  default: function () {
                    return o.default.call(this, {
                      onBlur: function () {
                        i.value.$el.querySelector(".genFromWidget_des") &&
                          i.value.onFieldBlur();
                      },
                      onChange: function () {
                        i.value.$el.querySelector(".genFromWidget_des") &&
                          i.value.onFieldChange();
                      },
                    });
                  },
                },
              ),
            );
          };
        },
      }),
      button: "a-button",
      popover: c({
        setup: function (t, r) {
          var a = r.attrs,
            n = r.slots;
          return function () {
            return e(m("a-popover"), a, {
              default: n.reference,
              content: n.default,
            });
          };
        },
      }),
    },
    HELPERS: {
      isMiniDes: function (e) {
        return (
          e &&
          (["left", "right"].includes(e.labelPosition) ||
            "horizontal" === e.layout ||
            !0 === e.inline)
        );
      },
    },
  },
  Xe = Te(Qe),
  et = Te(
    ue(
      ue({}, Qe),
      {},
      {
        COMPONENT_MAP: ue(
          ue({}, Qe.COMPONENT_MAP),
          {},
          {
            formItem: c({
              inheritAttrs: !1,
              setup: function (t, r) {
                var a = r.attrs,
                  n = r.slots;
                return function () {
                  var t = a.style,
                    r = a.class,
                    o = le(a, ["style", "class"]);
                  return e("div", { style: t, class: r }, [
                    e(Qe.COMPONENT_MAP.formItem, o, n),
                  ]);
                };
              },
            }),
          },
        ),
      },
    ),
  );
export default Xe;
export {
  et as JsonSchemaFormAntdV4,
  Ie as SchemaField,
  ve as fieldProps,
  Qe as globalOptions,
  We as i18n,
};
